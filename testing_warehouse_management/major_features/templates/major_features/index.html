{% extends "major_features/layout.html" %}

{% load humanize %}

{% block nav %}
<nav class="navbar navbar-expand-lg navbar-light" style="background-color: #01257D;">
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item" style="padding: 2.5px 5px 2.5px 5px;">
        <a class="nav-link" style="color: #00FFFF; border-bottom: 2px solid #00FFFF;" href="{% url 'index' %}">Trang chủ</a>
      </li>
      <li class="nav-item dropdown-trigger" style="padding: 2.5px 5px 2.5px 5px;">
        <a class="nav-link" style="color: white;" href="{% url 'import_shipments' %}">Nhập kho</a>
        <ul class="dropdown-ul">
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'import_shipments' %}" style="color: white; text-decoration: none;">
              Theo dõi lô hàng nhập kho
            </a>
          </li>
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'import_action' %}" style="color: white; text-decoration: none;">
              Thực hiện nhập kho
            </a>
          </li>
        </ul>
      </li>
      <li class="nav-item dropdown-trigger" style="padding: 2.5px 5px 2.5px 5px;">
        <a class="nav-link" style="color: white;" href="{% url 'export_shipments' %}">Xuất kho</a>
        <ul class="dropdown-ul">
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'export_shipments' %}" style="color: white; text-decoration: none;">
              Theo dõi lô hàng xuất kho
            </a>
          </li>
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'export_action' %}" style="color: white; text-decoration: none;">
              Thực hiện xuất kho
            </a>
          </li>
        </ul>
      </li>
      <li class="nav-item dropdown-trigger" style="padding: 2.5px 5px 2.5px 5px;">
        <a class="nav-link" style="color: white;" href="{% url 'reports_revenue' %}">Thống kê</a>
        <ul class="dropdown-ul">
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'reports_revenue' %}" style="color: white; text-decoration: none;">
              Doanh thu
            </a>
          </li>
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'reports_gross_profits' %}" style="color: white; text-decoration: none;">
              Lợi nhuận
            </a>
          </li>
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'reports_import_section' %}" style="color: white; text-decoration: none;">
              Nhập kho
            </a>
          </li>
          <li class="nav-item dropdown-li">
            <a class="nav-link" href="{% url 'reports_export_section' %}" style="color: white; text-decoration: none;">
              Xuất kho
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>
{% endblock %}

{% block title %}
<h2>Trang chủ</h2>
{% endblock %}

{% block body %}
<div id="products-container">
    <table class="table table-bordered table-striped table-dark">
      <caption>Bảng thống kê giá trị tồn kho hiện tại của từng sản phẩm</caption>
        <thead>
          <tr>
            <th scope="col" style="text-align: left;">Mã sản phẩm</th>
            <th scope="col" style="text-align: left;">Tên sản phẩm</th>
            <th scope="col" style="text-align: right;">Số lượng tồn kho</th>
            <th scope="col" style="text-align: right;">Tổng giá trị tồn kho</th>
          </tr>
        </thead>
        <tbody>
            {% for product in product_period_inventory %}
            <tr>
                <td scope="col">{{ product.product_id.sku }}</td>
                <td scope="col">{{ product.product_id.name }}</td>
                <td scope="col" style="text-align: right;">{{ product.ending_quantity|intcomma }}</td>
                <td scope="col" style="text-align: right;">{{ product.ending_inventory|intcomma }}</td>
              </tr>
            {% endfor %}
        </tbody>
      </table>
</div>

{% if method %}
<p>Phương pháp xác định giá trị hàng tồn kho đang được chọn: <strong>{{ method.name }}</strong></p>
<p><strong>Ngày bắt đầu ghi sổ kế toán: </strong>{{ accounting_period.date_applied }}</p>
<p><strong>Ngày kết thúc: </strong>{{ accounting_period.date_end }}</p>
{% else %}
<div class="alert alert-danger" role="alert">
    Không có phương pháp nào được chọn
    <a href="{% url 'apply_warehouse_management' %}">Tiến hành chọn phương pháp</a>
</div>
{% endif %}

<form action="{% url 'date_handling' %}" method="post">
    {% csrf_token %}
    {{ date_picker_form.as_p }}
    <input type="submit" value="Submit">
</form>

<p>
  <strong style="display: block; color: red;">Chỉ dành cho mục đích kiểm thử</strong>
  <a href="{% url 'apply_warehouse_management' %}">Chọn phương pháp khác để kiểm thử</a>
</p>

{% if alert_message %}
<div class="alert alert-danger" role="alert">
  {{ alert_message }}
  <a href="{% url 'activating_accounting_period' %}">Nhấn vào link này để tiến hành cập nhật phương pháp</a>
</div>
{% endif %}

{% endblock %}